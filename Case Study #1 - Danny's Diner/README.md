# Case Study #1 – Danny's Diner

![Danny's Diner Banner](https://github.com/user-attachments/assets/ce374cce-c9c3-447c-be97-9c42d65b054e)

---

[![SQL Skill](https://img.shields.io/badge/SQL-Skill-blue)](https://www.sqlcourse.com/)
[![Data Analysis Skill](https://img.shields.io/badge/Data%20Analysis-Skill-green)](https://www.coursera.org/learn/data-analysis)
[![Customer Insights](https://img.shields.io/badge/Customer-Insights-orange)](https://hbr.org/2015/05/the-science-of-customer-insights)
[![Business Insights](https://img.shields.io/badge/Business-Insights-red)](https://www.forbes.com/sites/insights)
[![Data-Driven](https://img.shields.io/badge/Data-Driven-purple)](https://www.datadrivenbusiness.com/)
[![GitHub Repo](https://img.shields.io/badge/GitHub-Repo-lightgrey)](https://github.com/your-username/your-repo)


---

## Introduction

Danny's Diner, launched in early 2021 by culinary enthusiast Danny, specializes in three signature Japanese dishes: **sushi, curry, and ramen**. Despite its appealing concept, the diner initially struggled to leverage its basic sales data effectively.  

This case study demonstrates how **data-driven insights** can improve operational efficiency, enhance customer satisfaction, and support long-term growth in a competitive restaurant market.

---

## Business Problem

Danny's Diner lacked actionable insights from its customer data, limiting its ability to optimize operations and enhance the customer experience. Key challenges included:

- Understanding **customer behavior**, such as visiting patterns and menu preferences.  
- Evaluating the **loyalty program’s effectiveness**.  
- Utilizing available datasets (sales, menu, members) effectively for decision-making.

---

## Business Questions

1. **Revenue Analysis:** Which menu items generate the highest revenue?  
2. **Customer Behavior:** How frequently do customers visit, and what is their typical spending pattern?  
3. **Loyalty Program Impact:** How does spending and purchasing behavior differ between loyalty program members and non-members?  
4. **Item Popularity:** What is the most purchased menu item overall?
5. **Inventory Insights:** Which items are most popular for each customer?  
6. **Loyalty Journey Analysis:** Which item was the first purchased after joining the loyalty program?
7. **Pre-Membership Behavior:** Which item was purchased last before the customer became a loyalty member?

## Available Dataset

The analysis uses three tables:

### 1. Sales Table (`dannys_diner.sales`)
Captures all purchases at the **customer_id** level, including `order_date` and `product_id`.  

![Sales Dataset](https://github.com/user-attachments/assets/9093a29a-d10b-40b1-8fb8-862cfda9dd90)

### 2. Menu Table (`dannys_diner.menu`)
Maps `product_id` to `product_name` and `price`.  

![Menu Dataset](https://github.com/user-attachments/assets/5d79d877-7806-489a-abe5-669535d8b52d)

### 3. Members Table (`dannys_diner.members`)
Records `join_date` when a customer enrolled in the loyalty program.  

![Members Dataset](https://github.com/user-attachments/assets/8dfff157-05e1-44b5-a126-c824a557ef5a)

---

## Entity Relationship Diagram (ERD)

![ERD](https://github.com/user-attachments/assets/10a5a471-b616-44f5-9bb8-e1c1b28bd1d6)

---

## Solution / Approach

For each business question, **SQL queries** were used to extract actionable insights. Below are **sql queries, explanations, outputs and actionable insights**.  

All full queries and outputs are available in [`dannys_diner.sql`](dannys_diner.sql).

---

<details>
<summary><h3>Business Question 1: Which menu items generate the highest revenue? </h3></summary>

**SQL Query:**

```sql
SELECT 
    m.product_name,
    SUM(s.price) AS total_revenue
FROM sales s
JOIN menu m ON s.product_id = m.product_id
GROUP BY m.product_name
ORDER BY total_revenue DESC;
```

**Explanation:** This query joins the sales and menu tables to calculate the total revenue generated by each menu item. By summing the prices of all sales per product and grouping them by product name, it identifies which dishes earn the most money. Ordering the results from highest to lowest revenue allows us to quickly see the most profitable items.

**Output:**
| product_name | total_revenue |
| ------------ | ------------- |
| ramen        | 96            |
| curry        | 60            |
| sushi        | 30            |

**Data Insight:**  
Ramen generated the highest total revenue of **$96**, followed by Curry (**$60**) and Sushi (**$30**). Combined, ramen and curry account for **~80% of total sales**, showing clear customer preference.

**Actionable Insights:**  
- **Ramen** generates the highest revenue – it is both popular and profitable.  
- **Curry** has moderate revenue – steady performer but could benefit from targeted promotion.  
- **Sushi** generates the least revenue – may need marketing support or menu repositioning.

**Recommended Actions:**  
1. **Promote top sellers:** Feature Ramen in combo deals or specials to maximize revenue.  
2. **Boost mid-performers:** Introduce limited-time offers for Curry to increase its sales.  
3. **Evaluate low performers:** Consider menu adjustments, cross-selling, or bundling for Sushi to increase customer interest.

</details>

---

<details>
<summary><h3> Business Question 2: Customer visit frequency & spending patterns </h3></summary>

**SQL Query:**
```sql
SELECT 
    s.customer_id,
    SUM(m.price) AS total_amount,
    COUNT(DISTINCT s.order_date) AS customer_visits,
    ROUND(SUM(m.price) / COUNT(DISTINCT s.order_date),2) AS avg_spending
FROM sales s
JOIN menu m ON s.product_id = m.product_id
GROUP BY s.customer_id
ORDER BY s.customer_id;
```
**Explanation:** The query calculates each customer’s total spending, the number of visits, and the average spending per visit. It joins the sales and menu tables to get prices, sums total spending per customer, counts unique visit dates, and computes average spend per visit. This helps understand customer engagement and value.

**Output:**
| customer_id | total_amount | customer_visits | avg_spending |
|------------ |------------- |---------------- |------------- |
| A           | 76           | 4               | 19.00        |
| B           | 74           | 6               | 12.33        |
| C           | 36           | 2               | 18.00        |

**Actionable Insights:**  
- Customer A: High-value per visit – strong per-visit spending.  
- Customer B: Most frequent visitor but lower per-visit spend – opportunity to increase spend.  
- Customer C: Low frequency and lower total spend – engagement opportunity.

**Recommended Actions:**  
1. Offer **personalized promotions** to increase spending for frequent but lower-value customers (e.g., B).  
2. Implement **loyalty incentives** to increase visits for low-frequency customers (e.g., C).  
3. Provide **exclusive offers** to high-value customers (e.g., A) to retain them and increase lifetime value.

</details>

---

<details>
<summary><h3>Business Question 3: Purchasing behavior differences: Members vs Non-Members?</h3></summary>

**SQL Query:**

```sql
SELECT 
    CASE WHEN m.customer_id IS NOT NULL THEN 'Y' ELSE 'N' END AS member,
    SUM(menu.price) AS total_spent,
    COUNT(DISTINCT s.customer_id) AS num_customers
FROM sales s
LEFT JOIN members m ON s.customer_id = m.customer_id
JOIN menu ON s.product_id = menu.product_id
GROUP BY member;
```

**Explanation:** This query evaluates how spending differs between loyalty program members and non-members. It joins the sales and menu tables and uses the members table to flag purchases as by a member (`Y`) or non-member (`N`). It sums total spending and counts the number of customers per group to measure the value of the loyalty program.

**Output:**

| member | total_spent | num_customers    |
|--------|------------ |------------------|
| N      | 36          | 1                |
| Y      | 150         | 2                |

**Actionable Insights:**  
- **Members spend significantly more** than non-members, showing the loyalty program drives higher revenue.  
- **Fewer non-members** but lower spending indicates untapped revenue potential.  
- Encouraging non-members to join the program can boost overall sales and engagement.

**Recommended Actions:**  
1. **Promote loyalty program enrollment** to non-members with attractive incentives (e.g., discounts, free items).  
2. **Reward high-spending members** with exclusive offers to retain them and increase lifetime value.  
3. **Analyze member behavior** to identify opportunities for targeted promotions and upselling.

</details>

---

<details> 
<summary><h3>Business Question 4: What is the most purchased menu item overall?</h3></summary>

**SQL Query:**
```sql
SELECT 
    m.product_name,
    COUNT(*) AS times_ordered
FROM sales s
JOIN menu m ON s.product_id = m.product_id
GROUP BY m.product_name
ORDER BY times_ordered DESC;
```
**Explanation:** This query identifies which menu item was purchased the most across all customers. It joins sales with menu to map product IDs to names, counts the total orders per item, and ranks them to see overall popularity.

**Output:**
| product_name | times_ordered |
| ------------ | ------------- |
| ramen        | 8             |
| curry        | 4             |
| sushi        | 3             |

**Actionable Insights:**
- **Ramen is the most popular menu item**, showing it drives the highest customer demand.
- **Curry and sushi have lower purchase counts**, indicating potential areas for promotion or menu adjustment.
- **High-demand items like ramen** should be prioritized in inventory management to avoid stockouts and maximize sales.

**Recommended Actions:**
1. **Promote ramen specials or combo meals** to capitalize on its popularity and increase revenue.
2. **Create targeted campaigns for curry and sushi** to improve sales of underperforming items.
3. **Align inventory and purchasing decisions** with item popularity to reduce waste and ensure supply meets demand.

</details>

---

<details> 
<summary><h3> Business Question 5: What is the most popular item per customer?  </h3></summary>

**SQL Query:**
```sql
WITH customer_item_count AS (
    SELECT 
        s.customer_id,
        m.product_name,
        COUNT(*) AS times_purchased
    FROM sales s
    JOIN menu m ON s.product_id = m.product_id
    GROUP BY s.customer_id, m.product_name
),
ranked_items AS (
    SELECT 
        customer_id,
        product_name,
        times_purchased,
        RANK() OVER (PARTITION BY customer_id ORDER BY times_purchased DESC) AS rnk
    FROM customer_item_count
)
SELECT 
    customer_id,
    product_name AS most_popular_item,
    times_purchased
FROM ranked_items
WHERE rnk = 1
ORDER BY customer_id;

```
**Explanation:** This query identifies the most frequently purchased menu item(s) for each customer. By joining sales and menu, grouping by customer and product, and ranking purchase counts, we isolate each customer’s top item(s). This helps understand individual customer preferences — crucial for personalization and retention strategies.

**Output:**
| customer_id | most_popular_item   | times_purchased |
| ----------  | ------------------- | --------------- |
| A           | ramen               | 3               |
| B           | curry, sushi, ramen | 2               |
| C           | ramen               | 3               |

**Actionable Insights:**
- **Ramen stands out** as the most popular item across customers, highlighting it as the restaurant’s top-performing product.
- **Customer B shows diverse preferences**, making them ideal for testing new menu items or combo offers.
- **Customers A and C are loyal ramen buyers**, presenting an opportunity to deepen engagement through targeted ramen-based offers.

**Recommended Actions:**
1. **Promote ramen as the restaurant’s signature dish** through marketing campaigns or limited-time bundles.
2. **Personalize offers** for ramen lovers (A & C) — for example, loyalty points multipliers or free toppings.
3. **Encourage variety-seeking customers like B** with tailored “Chef’s Choice” or “New Arrivals” promotions.

</details>

---

<details> 
<summary><h3> Business Question 6: What is the first item purchased after becoming a member?  </h3></summary>

**SQL Query:**
```sql
WITH FirstPurAfterMember AS
(
	SELECT 
		s.customer_id, 
		product_name, 
        order_date,
        join_date,
		DENSE_RANK() OVER
        (
			PARTITION BY s.customer_id 
            ORDER BY join_date, order_date
		) AS purchase_ranking
	FROM sales s
	JOIN members m
	ON s.customer_id = m.customer_id
	JOIN menu mu
	ON s.product_id = mu.product_id
	WHERE order_date >= join_date
)
SELECT 
	customer_id,
    product_name,
    order_date,
    join_date
FROM FirstPurAfterMember
WHERE purchase_ranking = 1;

```
**Explanation:** This query identifies the first item each customer purchased after joining the loyalty program. By comparing the customer’s join date with their order date, we uncover how customers behave right after enrollment — providing insights into post-membership engagement and loyalty-driven actions.

**Output:**
| customer_id | product_name | order_date | join_date |
| ------------| -------------| -----------| --------- |
| A           | curry        | 2021-01-07 | 2021-01-07|
| B           | sushi        | 2021-01-11 | 2021-01-09|

**Actionable Insights:**
- **Customers make their first purchase almost immediately after joining**, showing strong early engagement.
- **Preferred items remain consistent** (curry and sushi), indicating trust in familiar choices rather than exploring new ones.
- **Prompt post-membership spending** signals an opportunity to strengthen long-term loyalty through timely engagement.

**Recommended Actions:**
1. **Send personalized welcome offers** immediately after a customer joins — e.g., “Thanks for joining! Earn double points on your next visit.”
2. **Leverage behavioral data** to tailor recommendations around their favorite items (like curry or sushi).
3. **Design onboarding campaigns** to maintain excitement during the first week after membership.
   
</details>

---

<details> 
<summary><h3> Business Question 7: Most Recent Pre-Membership Purchase </h3></summary>

**SQL Query:**
```sql
WITH FirstPurAfterMember AS
(
	SELECT 
		s.customer_id, 
		product_name, 
        order_date,
        join_date,
		DENSE_RANK() OVER
        (
			PARTITION BY s.customer_id 
            ORDER BY join_date, order_date
		) AS purchase_ranking
	FROM sales s
	JOIN members m
	ON s.customer_id = m.customer_id
	JOIN menu mu
	ON s.product_id = mu.product_id
	WHERE order_date >= join_date
)
SELECT 
	customer_id,
    product_name,
    order_date,
    join_date
FROM FirstPurAfterMember
WHERE purchase_ranking = 1;
```

**Explanation:** This query identifies the last item(s) each customer purchased before joining the loyalty program. It uses a Common Table Expression (CTE) and the RANK() window function to determine the most recent purchase(s) made prior to the customer’s join date.

**Output:**
| customer_id | product_name | order_date | join_date  |
| ------------| ------------ | ---------- | ---------- |
| A           | sushi        | 2021-01-01 | 2021-01-07 |
| A           | curry        | 2021-01-01 | 2021-01-07 |
| B           | sushi        | 2021-01-04 | 2021-01-09 |

**Actionable Insights:**
- **Customers often make purchases right before joining**, showing strong brand engagement even before loyalty enrollment.
- **Customer A** purchased both Sushi and Curry before joining, suggesting interest in product variety.
- **Understanding pre-join behavior** helps predict which customers are likely to convert to loyalty members

**Recommended Actions:**
1. **Monitor frequent buyers** to target them with timely loyalty program invitations.
2. **Offer “Join Now, Earn Points on This Purchase”** promotions to capture pre-conversion customers.
3. **Bundle popular pre-join items** into exclusive membership offers to strengthen onboarding engagement.
   
</details>

---

## Skills Demonstrated
| SQL Concept      | Description                               |
| ---------------- | ----------------------------------------- |
| JOIN             | Combined sales, menu, and member tables   |
| GROUP BY         | Aggregated revenue and frequency per item |
| ORDER BY         | Ranked items by revenue or popularity     |
| Window Functions | Calculated running totals and item ranks  |
| CASE Statements  | Conditional logic for member flags        |

---

## Optional Insights / Lessons Learned:

Data cleanliness and consistent ID formats are essential.

Structuring queries around business questions ensures insights are actionable.

Analysis can directly improve customer satisfaction, retention, and revenue.

---

## Resources

1. [8 Week SQL Challenge](https://8weeksqlchallenge.com/) - Official website with all case studies.
2. [Case Study #1 - Danny's Diner](https://8weeksqlchallenge.com/case-study-1/) - Direct link to the case study details.
















